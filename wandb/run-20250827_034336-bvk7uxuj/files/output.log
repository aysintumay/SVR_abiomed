Starting trial 1 with gamma1=0.05, gamma2=0.2, gamma3=0.5
cuda:6
In env continuous
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
/home/ubuntu/miniconda3/envs/mopo/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/home/ubuntu/noisy_mujoco/abiomed_env/model.py:402: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(path, map_location=self.device)
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
No validation data for Abiomed dataset
0.05 0.2 0.5
torch.Size([17865, 6, 12]) torch.Size([17865, 6]) torch.Size([17865, 66])
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17865/17865 [00:08<00:00, 2029.02it/s]
-4.428163142542622 165.93485669748776
-2.736237 1.3035817
-5.897560220908415 83.67061508289387
-2.35 1.5392697494459262
1.0 1.0
/home/ubuntu/SVR/SVR_old/main.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  behav.load_state_dict(torch.load(bc_model_path))
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
EVAL ENVIRONMENT GAMMAS SET TO 0
 15%|███████████████████                                                                                                            | 29994/200000 [06:13<1:31:36, 30.93it/s]
-11.122398376464844
Time steps: 10000
---------------------------------------
Evaluation over 10 episodes: Return 3.229
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.15333333333333335
Super metric: 0.20000
---------------------------------------
-13.35244369506836
Time steps: 20000
---------------------------------------
Evaluation over 10 episodes: Return 2.507
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.2
Super metric: 0.00000
---------------------------------------
-19.356678009033203
Time steps: 30000
---------------------------------------
Evaluation over 10 episodes: Return -1.293
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 8.333333333333332
Weaning score: 0.17833333333333334
Super metric: 0.10000
---------------------------------------
-38.4947624206543
Time steps: 40000
---------------------------------------
Evaluation over 10 episodes: Return 1.386
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 3.333333333333333
Weaning score: 0.02
Super metric: 0.30000
---------------------------------------
-57.88029479980469
Time steps: 50000
---------------------------------------
Evaluation over 10 episodes: Return 1.007
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.08
Super metric: 0.00000
---------------------------------------
-78.35594177246094
Time steps: 60000
---------------------------------------
Evaluation over 10 episodes: Return 0.512
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.04
Super metric: 0.50000
---------------------------------------
-97.74451446533203
Time steps: 70000
---------------------------------------
Evaluation over 10 episodes: Return -0.675
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 6.666666666666666
Weaning score: 0.18
Super metric: 0.30000
---------------------------------------
-119.25531768798828
Time steps: 80000
---------------------------------------
Evaluation over 10 episodes: Return -3.769
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 15.0
Weaning score: 0.17333333333333334
Super metric: 0.10000
---------------------------------------
-139.49142456054688
Time steps: 90000
---------------------------------------
Evaluation over 10 episodes: Return 0.424
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 4.999999999999999
Weaning score: 0.04
Super metric: 0.00000
---------------------------------------
-165.20079040527344
Time steps: 100000
---------------------------------------
Evaluation over 10 episodes: Return 0.238
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 6.666666666666666
Weaning score: 0.05333333333333333
Super metric: 0.40000
---------------------------------------
-178.5196990966797
Time steps: 110000
---------------------------------------
Evaluation over 10 episodes: Return -2.708
ACP 0.3000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.02500
Aggregate AIR/ep: 0.52500
Unstable hours (%): 1.6666666666666665
Weaning score: 0.045
Super metric: 0.20000
---------------------------------------
-197.22256469726562
Time steps: 120000
---------------------------------------
Evaluation over 10 episodes: Return 0.502
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.30000
Unstable hours (%): 21.666666666666664
Weaning score: 0.1
Super metric: 0.60000
---------------------------------------
-217.414306640625
Time steps: 130000
---------------------------------------
Evaluation over 10 episodes: Return -0.094
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 4.999999999999999
Weaning score: 0.045
Super metric: 0.30000
---------------------------------------
-218.39071655273438
Time steps: 140000
---------------------------------------
Evaluation over 10 episodes: Return 0.143
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 14.999999999999996
Weaning score: 0.12
Super metric: 0.30000
---------------------------------------
-238.49281311035156
Time steps: 150000
---------------------------------------
Evaluation over 10 episodes: Return 1.570
ACP 0.9000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 0.0
Weaning score: 0.20166666666666666
Super metric: 1.20000
---------------------------------------
-229.67666625976562
Time steps: 160000
---------------------------------------
Evaluation over 10 episodes: Return 1.865
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.30000
Unstable hours (%): 8.333333333333332
Weaning score: 0.07666666666666666
Super metric: 0.60000
---------------------------------------
-230.2047119140625
Time steps: 170000
---------------------------------------
Evaluation over 10 episodes: Return -0.996
ACP 1.1000
MAP AIR/ep: 0.02000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.92000
Unstable hours (%): 11.666666666666666
Weaning score: 0.08
Super metric: 0.70000
---------------------------------------
-235.91473388671875
Time steps: 180000
---------------------------------------
Evaluation over 10 episodes: Return -0.508
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.08
Super metric: 0.70000
---------------------------------------
-230.33750915527344
Time steps: 190000
---------------------------------------
Evaluation over 10 episodes: Return 0.811
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 0.0
Weaning score: 0.24666666666666667
Super metric: 0.40000
---------------------------------------
-224.40087890625
Time steps: 200000
---------------------------------------
Evaluation over 100 episodes: Return 0.874
ACP 0.2600
MAP AIR/ep: 0.00333 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00650
Aggregate AIR/ep: 0.59983
Unstable hours (%): 4.833333333333334
Weaning score: 0.16649999999999995
Super metric: 0.37000
---------------------------------------
Saved policy to /abiomed/models/policy_models/SVR_hpo/abiomed/2025-08-27_03-43-24/svr_seed_1_1_gamma1_0.05_gamma2_0.2_gamma3_0.5.pth
