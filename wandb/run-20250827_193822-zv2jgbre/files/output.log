Starting trial 22 with gamma1=0.2, gamma2=0.5, gamma3=0.5
cuda:6
In env continuous
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
/home/ubuntu/miniconda3/envs/mopo/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/home/ubuntu/noisy_mujoco/abiomed_env/model.py:402: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(path, map_location=self.device)
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
No validation data for Abiomed dataset
0.2 0.5 0.5
torch.Size([17865, 6, 12]) torch.Size([17865, 6]) torch.Size([17865, 66])
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17865/17865 [00:08<00:00, 2165.66it/s]
-4.428163142542622 165.93485669748776
-2.736237 1.3035817
-5.897560220908415 83.67061508289387
-3.4000000000000004 2.1392697494459263
1.0 1.0
/home/ubuntu/SVR/SVR_old/main.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  behav.load_state_dict(torch.load(bc_model_path))
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
EVAL ENVIRONMENT GAMMAS SET TO 0
 15%|███████████████████▎                                                                                                             | 29998/200000 [07:22<32:19, 87.63it/s]
0.10720102488994598
Time steps: 10000
---------------------------------------
Evaluation over 10 episodes: Return 3.273
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.34666666666666673
Super metric: 0.20000
---------------------------------------
-6.131582260131836
Time steps: 20000
---------------------------------------
Evaluation over 10 episodes: Return 2.569
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.18
Super metric: 0.00000
---------------------------------------
-18.119731903076172
Time steps: 30000
---------------------------------------
Evaluation over 10 episodes: Return -0.621
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 8.333333333333332
Weaning score: 0.1983333333333333
Super metric: 0.10000
---------------------------------------
-41.67472839355469
Time steps: 40000
---------------------------------------
Evaluation over 10 episodes: Return 1.040
ACP 0.0000
MAP AIR/ep: 0.05000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.85000
Unstable hours (%): 3.333333333333333
Weaning score: 0.1733333333333333
Super metric: -0.10000
---------------------------------------
-70.97071075439453
Time steps: 50000
---------------------------------------
Evaluation over 10 episodes: Return 1.220
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.14999999999999997
Super metric: 0.10000
---------------------------------------
-95.307861328125
Time steps: 60000
---------------------------------------
Evaluation over 10 episodes: Return 0.562
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.04
Super metric: 0.10000
---------------------------------------
-116.48416137695312
Time steps: 70000
---------------------------------------
Evaluation over 10 episodes: Return -0.774
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 6.666666666666666
Weaning score: 0.32
Super metric: 0.30000
---------------------------------------
-139.978759765625
Time steps: 80000
---------------------------------------
Evaluation over 10 episodes: Return -3.746
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 16.666666666666664
Weaning score: 0.1
Super metric: 0.00000
---------------------------------------
-167.11917114257812
Time steps: 90000
---------------------------------------
Evaluation over 10 episodes: Return 0.539
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.02000
Aggregate AIR/ep: 0.62000
Unstable hours (%): 3.333333333333333
Weaning score: 0.08
Super metric: 0.20000
---------------------------------------
-194.2707977294922
Time steps: 100000
---------------------------------------
Evaluation over 10 episodes: Return 0.302
ACP 0.4000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 6.666666666666666
Weaning score: 0.06000000000000001
Super metric: 0.50000
---------------------------------------
-209.51202392578125
Time steps: 110000
---------------------------------------
Evaluation over 10 episodes: Return -2.686
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.06999999999999999
Super metric: 0.40000
---------------------------------------
-220.4067840576172
Time steps: 120000
---------------------------------------
Evaluation over 10 episodes: Return 0.786
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.20000
Unstable hours (%): 21.666666666666664
Weaning score: 0.10833333333333332
Super metric: 0.30000
---------------------------------------
-234.7196044921875
Time steps: 130000
---------------------------------------
Evaluation over 10 episodes: Return -0.109
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 4.999999999999999
Weaning score: 0.11499999999999999
Super metric: 0.20000
---------------------------------------
-228.74508666992188
Time steps: 140000
---------------------------------------
Evaluation over 10 episodes: Return 0.168
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 14.999999999999996
Weaning score: 0.16499999999999998
Super metric: 0.40000
---------------------------------------
-249.49215698242188
Time steps: 150000
---------------------------------------
Evaluation over 10 episodes: Return 1.560
ACP 0.6000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 0.0
Weaning score: 0.12666666666666665
Super metric: 0.70000
---------------------------------------
-246.5989227294922
Time steps: 160000
---------------------------------------
Evaluation over 10 episodes: Return 1.673
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.30000
Unstable hours (%): 9.999999999999996
Weaning score: 0.08
Super metric: 0.40000
---------------------------------------
-251.22093200683594
Time steps: 170000
---------------------------------------
Evaluation over 10 episodes: Return -1.065
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 10.0
Weaning score: 0.085
Super metric: 0.20000
---------------------------------------
-263.5863342285156
Time steps: 180000
---------------------------------------
Evaluation over 10 episodes: Return -0.496
ACP 0.7000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 0.0
Weaning score: 0.05333333333333333
Super metric: 1.10000
---------------------------------------
-263.639404296875
Time steps: 190000
---------------------------------------
Evaluation over 10 episodes: Return 0.862
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 0.0
Weaning score: 0.06000000000000001
Super metric: 0.60000
---------------------------------------
-268.1319580078125
Time steps: 200000
---------------------------------------
Evaluation over 100 episodes: Return 0.848
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.01000
Aggregate AIR/ep: 0.63000
Unstable hours (%): 4.500000000000001
Weaning score: 0.1951666666666666
Super metric: 0.34000
---------------------------------------
Saved policy to /abiomed/models/policy_models/SVR_hpo/abiomed/2025-08-27_03-43-24/svr_seed_1_22_gamma1_0.2_gamma2_0.5_gamma3_0.5.pth
