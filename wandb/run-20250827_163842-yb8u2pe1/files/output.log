Starting trial 18 with gamma1=0.2, gamma2=0.2, gamma3=0.1
cuda:6
In env continuous
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
/home/ubuntu/miniconda3/envs/mopo/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/home/ubuntu/noisy_mujoco/abiomed_env/model.py:402: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(path, map_location=self.device)
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
No validation data for Abiomed dataset
0.2 0.2 0.1
torch.Size([17865, 6, 12]) torch.Size([17865, 6]) torch.Size([17865, 66])
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17865/17865 [00:08<00:00, 2130.08it/s]
-4.428163142542622 165.93485669748776
-2.736237 1.3035817
-5.897560220908415 83.67061508289387
-3.5 1.139269749445926
1.0 1.0
/home/ubuntu/SVR/SVR_old/main.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  behav.load_state_dict(torch.load(bc_model_path))
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
EVAL ENVIRONMENT GAMMAS SET TO 0
 15%|███████████████████▎                                                                                                             | 29990/200000 [07:13<31:37, 89.62it/s]
-3.9749975204467773
Time steps: 10000
---------------------------------------
Evaluation over 10 episodes: Return 3.096
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.4533333333333333
Super metric: 0.20000
---------------------------------------
-14.925445556640625
Time steps: 20000
---------------------------------------
Evaluation over 10 episodes: Return 2.675
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.27999999999999997
Super metric: 0.10000
---------------------------------------
-30.786151885986328
Time steps: 30000
---------------------------------------
Evaluation over 10 episodes: Return -0.919
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 6.666666666666666
Weaning score: 0.32500000000000007
Super metric: 0.20000
---------------------------------------
-56.49125671386719
Time steps: 40000
---------------------------------------
Evaluation over 10 episodes: Return 1.478
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 3.333333333333333
Weaning score: 0.08
Super metric: 0.10000
---------------------------------------
-89.35833740234375
Time steps: 50000
---------------------------------------
Evaluation over 10 episodes: Return 0.958
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.04
Super metric: 0.10000
---------------------------------------
-117.00267028808594
Time steps: 60000
---------------------------------------
Evaluation over 10 episodes: Return 0.188
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.195
Super metric: 0.40000
---------------------------------------
-141.48240661621094
Time steps: 70000
---------------------------------------
Evaluation over 10 episodes: Return -0.688
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 6.666666666666666
Weaning score: 0.145
Super metric: 0.30000
---------------------------------------
-166.98593139648438
Time steps: 80000
---------------------------------------
Evaluation over 10 episodes: Return -3.747
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 16.666666666666664
Weaning score: 0.13999999999999999
Super metric: 0.70000
---------------------------------------
-193.24749755859375
Time steps: 90000
---------------------------------------
Evaluation over 10 episodes: Return 0.597
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.04
Super metric: 0.30000
---------------------------------------
-215.21038818359375
Time steps: 100000
---------------------------------------
Evaluation over 10 episodes: Return 0.118
ACP 0.0000
MAP AIR/ep: 0.05000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.10000
Aggregate AIR/ep: 0.85000
Unstable hours (%): 6.666666666666666
Weaning score: 0.08
Super metric: 0.00000
---------------------------------------
-240.83628845214844
Time steps: 110000
---------------------------------------
Evaluation over 10 episodes: Return -2.904
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.13333
Aggregate AIR/ep: 0.63333
Unstable hours (%): 1.6666666666666665
Weaning score: 0.175
Super metric: 0.10000
---------------------------------------
-254.5037384033203
Time steps: 120000
---------------------------------------
Evaluation over 10 episodes: Return 0.710
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.20000
Unstable hours (%): 21.666666666666664
Weaning score: 0.13166666666666665
Super metric: 0.10000
---------------------------------------
-272.50634765625
Time steps: 130000
---------------------------------------
Evaluation over 10 episodes: Return -0.109
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 4.999999999999999
Weaning score: 0.16
Super metric: 0.20000
---------------------------------------
-267.43695068359375
Time steps: 140000
---------------------------------------
Evaluation over 10 episodes: Return 0.054
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 14.999999999999996
Weaning score: 0.16499999999999998
Super metric: 0.30000
---------------------------------------
-295.92578125
Time steps: 150000
---------------------------------------
Evaluation over 10 episodes: Return 1.548
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.065
Super metric: 0.10000
---------------------------------------
-292.5254211425781
Time steps: 160000
---------------------------------------
Evaluation over 10 episodes: Return 1.611
ACP 0.6000
MAP AIR/ep: 0.10000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.40000
Unstable hours (%): 8.333333333333332
Weaning score: 0.25
Super metric: -0.20000
---------------------------------------
-316.6313171386719
Time steps: 170000
---------------------------------------
Evaluation over 10 episodes: Return -1.317
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 10.0
Weaning score: 0.13
Super metric: 0.30000
---------------------------------------
-331.2980041503906
Time steps: 180000
---------------------------------------
Evaluation over 10 episodes: Return -0.400
ACP 0.6000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.08
Super metric: 1.40000
---------------------------------------
-332.8049011230469
Time steps: 190000
---------------------------------------
Evaluation over 10 episodes: Return 1.392
ACP 1.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.04
Super metric: 1.60000
---------------------------------------
-336.06707763671875
Time steps: 200000
---------------------------------------
Evaluation over 100 episodes: Return 0.952
ACP 0.8000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00650
Aggregate AIR/ep: 0.59650
Unstable hours (%): 4.000000000000001
Weaning score: 0.22399999999999998
Super metric: 0.92000
---------------------------------------
Saved policy to /abiomed/models/policy_models/SVR_hpo/abiomed/2025-08-27_03-43-24/svr_seed_1_18_gamma1_0.2_gamma2_0.2_gamma3_0.1.pth
