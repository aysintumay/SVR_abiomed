Starting trial 17 with gamma1=0.1, gamma2=0.7, gamma3=1.0
cuda:6
In env continuous
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
/home/ubuntu/miniconda3/envs/mopo/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/home/ubuntu/noisy_mujoco/abiomed_env/model.py:402: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(path, map_location=self.device)
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
No validation data for Abiomed dataset
0.1 0.7 1.0
torch.Size([17865, 6, 12]) torch.Size([17865, 6]) torch.Size([17865, 66])
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17865/17865 [00:07<00:00, 2241.35it/s]
-4.428163142542622 165.93485669748776
-2.736237 1.3035817
-5.897560220908415 83.67061508289387
-2.7 3.0392697494459258
1.0 1.0
/home/ubuntu/SVR/SVR_old/main.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  behav.load_state_dict(torch.load(bc_model_path))
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
EVAL ENVIRONMENT GAMMAS SET TO 0
 15%|███████████████████▎                                                                                                             | 29998/200000 [06:22<31:10, 90.88it/s]
-1.9036508798599243
Time steps: 10000
---------------------------------------
Evaluation over 10 episodes: Return 3.108
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.33333333333333337
Super metric: 0.20000
---------------------------------------
-3.6055054664611816
Time steps: 20000
---------------------------------------
Evaluation over 10 episodes: Return 2.668
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.12000000000000002
Super metric: 0.00000
---------------------------------------
-9.411090850830078
Time steps: 30000
---------------------------------------
Evaluation over 10 episodes: Return -1.218
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 8.333333333333332
Weaning score: 0.23833333333333337
Super metric: 0.20000
---------------------------------------
-26.150352478027344
Time steps: 40000
---------------------------------------
Evaluation over 10 episodes: Return 1.169
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 3.333333333333333
Weaning score: 0.1
Super metric: 0.30000
---------------------------------------
-49.29639434814453
Time steps: 50000
---------------------------------------
Evaluation over 10 episodes: Return 0.860
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.13333333333333333
Super metric: 0.20000
---------------------------------------
-72.73658752441406
Time steps: 60000
---------------------------------------
Evaluation over 10 episodes: Return 0.023
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.13333333333333333
Super metric: 0.20000
---------------------------------------
-100.72134399414062
Time steps: 70000
---------------------------------------
Evaluation over 10 episodes: Return -0.821
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 3.333333333333333
Weaning score: 0.08
Super metric: 0.10000
---------------------------------------
-127.42919921875
Time steps: 80000
---------------------------------------
Evaluation over 10 episodes: Return -3.774
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 15.0
Weaning score: 0.02
Super metric: 0.20000
---------------------------------------
-156.1477508544922
Time steps: 90000
---------------------------------------
Evaluation over 10 episodes: Return 0.572
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.08
Super metric: 0.20000
---------------------------------------
-190.24017333984375
Time steps: 100000
---------------------------------------
Evaluation over 10 episodes: Return 0.836
ACP 0.6000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 6.666666666666666
Weaning score: 0.12
Super metric: 0.70000
---------------------------------------
-211.64720153808594
Time steps: 110000
---------------------------------------
Evaluation over 10 episodes: Return -3.184
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.16499999999999998
Super metric: 0.20000
---------------------------------------
-230.03871154785156
Time steps: 120000
---------------------------------------
Evaluation over 10 episodes: Return 0.714
ACP 0.6000
MAP AIR/ep: 0.05000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.15000
Unstable hours (%): 21.666666666666664
Weaning score: 0.08
Super metric: 1.00000
---------------------------------------
-244.70375061035156
Time steps: 130000
---------------------------------------
Evaluation over 10 episodes: Return -0.369
ACP 0.7000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.40000
Unstable hours (%): 4.999999999999999
Weaning score: 0.205
Super metric: 0.90000
---------------------------------------
-245.17108154296875
Time steps: 140000
---------------------------------------
Evaluation over 10 episodes: Return 0.258
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 14.999999999999996
Weaning score: 0.18
Super metric: 0.40000
---------------------------------------
-257.531494140625
Time steps: 150000
---------------------------------------
Evaluation over 10 episodes: Return 1.497
ACP 0.8000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.16
Super metric: 1.50000
---------------------------------------
-246.04940795898438
Time steps: 160000
---------------------------------------
Evaluation over 10 episodes: Return 1.636
ACP 0.4000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.30000
Unstable hours (%): 9.999999999999996
Weaning score: 0.265
Super metric: 0.90000
---------------------------------------
-245.24557495117188
Time steps: 170000
---------------------------------------
Evaluation over 10 episodes: Return -0.984
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 11.666666666666666
Weaning score: 0.14666666666666667
Super metric: 0.40000
---------------------------------------
-242.12615966796875
Time steps: 180000
---------------------------------------
Evaluation over 10 episodes: Return -0.413
ACP 1.4000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 0.0
Weaning score: 0.165
Super metric: 1.90000
---------------------------------------
-223.9231414794922
Time steps: 190000
---------------------------------------
Evaluation over 10 episodes: Return 0.838
ACP 1.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.08
Super metric: 0.90000
---------------------------------------
-226.89910888671875
Time steps: 200000
---------------------------------------
Evaluation over 100 episodes: Return 0.863
ACP 0.8000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00200
Aggregate AIR/ep: 0.58200
Unstable hours (%): 5.333333333333334
Weaning score: 0.16949999999999996
Super metric: 0.94000
---------------------------------------
Saved policy to /abiomed/models/policy_models/SVR_hpo/abiomed/2025-08-27_03-43-24/svr_seed_1_17_gamma1_0.1_gamma2_0.7_gamma3_1.0.pth
