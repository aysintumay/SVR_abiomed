Starting trial 9 with gamma1=0.1, gamma2=0.2, gamma3=0.1
cuda:6
In env continuous
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
/home/ubuntu/miniconda3/envs/mopo/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/home/ubuntu/noisy_mujoco/abiomed_env/model.py:402: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(path, map_location=self.device)
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
No validation data for Abiomed dataset
0.1 0.2 0.1
torch.Size([17865, 6, 12]) torch.Size([17865, 6]) torch.Size([17865, 66])
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17865/17865 [00:08<00:00, 2089.80it/s]
-4.428163142542622 165.93485669748776
-2.736237 1.3035817
-5.897560220908415 83.67061508289387
-2.8 1.139269749445926
1.0 1.0
/home/ubuntu/SVR/SVR_old/main.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  behav.load_state_dict(torch.load(bc_model_path))
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
EVAL ENVIRONMENT GAMMAS SET TO 0
 15%|███████████████████▎                                                                                                             | 29996/200000 [06:10<29:26, 96.26it/s]
-2.723139762878418
Time steps: 10000
---------------------------------------
Evaluation over 10 episodes: Return 3.225
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.19333333333333333
Super metric: 0.00000
---------------------------------------
-12.285444259643555
Time steps: 20000
---------------------------------------
Evaluation over 10 episodes: Return 2.627
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.12000000000000002
Super metric: 0.10000
---------------------------------------
-26.052169799804688
Time steps: 30000
---------------------------------------
Evaluation over 10 episodes: Return -1.120
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 8.333333333333332
Weaning score: 0.265
Super metric: 0.10000
---------------------------------------
-49.907859802246094
Time steps: 40000
---------------------------------------
Evaluation over 10 episodes: Return 1.275
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 3.333333333333333
Weaning score: 0.06000000000000001
Super metric: 0.30000
---------------------------------------
-76.99309539794922
Time steps: 50000
---------------------------------------
Evaluation over 10 episodes: Return 1.250
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.08
Super metric: 0.00000
---------------------------------------
-96.00475311279297
Time steps: 60000
---------------------------------------
Evaluation over 10 episodes: Return 0.333
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.15333333333333332
Super metric: 0.30000
---------------------------------------
-116.0058822631836
Time steps: 70000
---------------------------------------
Evaluation over 10 episodes: Return -0.776
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 6.666666666666666
Weaning score: 0.12
Super metric: 0.30000
---------------------------------------
-138.21319580078125
Time steps: 80000
---------------------------------------
Evaluation over 10 episodes: Return -3.614
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 15.0
Weaning score: 0.06999999999999999
Super metric: 0.00000
---------------------------------------
-156.38888549804688
Time steps: 90000
---------------------------------------
Evaluation over 10 episodes: Return 0.555
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.02000
Aggregate AIR/ep: 0.62000
Unstable hours (%): 3.333333333333333
Weaning score: 0.2
Super metric: 0.40000
---------------------------------------
-175.23233032226562
Time steps: 100000
---------------------------------------
Evaluation over 10 episodes: Return 0.039
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 6.666666666666666
Weaning score: 0.1
Super metric: 0.20000
---------------------------------------
-187.51695251464844
Time steps: 110000
---------------------------------------
Evaluation over 10 episodes: Return -2.569
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.06000000000000001
Super metric: 0.50000
---------------------------------------
-191.73780822753906
Time steps: 120000
---------------------------------------
Evaluation over 10 episodes: Return 0.654
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.30000
Unstable hours (%): 21.666666666666664
Weaning score: 0.025
Super metric: 0.30000
---------------------------------------
-201.7889862060547
Time steps: 130000
---------------------------------------
Evaluation over 10 episodes: Return -0.202
ACP 0.3000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 4.999999999999999
Weaning score: 0.225
Super metric: 0.90000
---------------------------------------
-199.12106323242188
Time steps: 140000
---------------------------------------
Evaluation over 10 episodes: Return 0.129
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 14.999999999999996
Weaning score: 0.18833333333333332
Super metric: 0.40000
---------------------------------------
-212.09600830078125
Time steps: 150000
---------------------------------------
Evaluation over 10 episodes: Return 1.663
ACP 0.3000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.06000000000000001
Super metric: 0.30000
---------------------------------------
-211.81265258789062
Time steps: 160000
---------------------------------------
Evaluation over 10 episodes: Return 1.706
ACP 0.8000
MAP AIR/ep: 0.10000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.05000
Aggregate AIR/ep: 0.45000
Unstable hours (%): 9.999999999999996
Weaning score: 0.135
Super metric: 0.20000
---------------------------------------
-219.1035614013672
Time steps: 170000
---------------------------------------
Evaluation over 10 episodes: Return -1.146
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 11.666666666666666
Weaning score: 0.18666666666666668
Super metric: 0.50000
---------------------------------------
-225.76596069335938
Time steps: 180000
---------------------------------------
Evaluation over 10 episodes: Return -0.257
ACP 0.7000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 0.0
Weaning score: 0.14
Super metric: 1.00000
---------------------------------------
-221.0682373046875
Time steps: 190000
---------------------------------------
Evaluation over 10 episodes: Return 0.992
ACP 0.7000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 0.0
Weaning score: 0.22666666666666666
Super metric: 1.00000
---------------------------------------
-223.69009399414062
Time steps: 200000
---------------------------------------
Evaluation over 100 episodes: Return 0.881
ACP 1.0200
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00400
Aggregate AIR/ep: 0.59400
Unstable hours (%): 6.0
Weaning score: 0.2036666666666666
Super metric: 1.22000
---------------------------------------
Saved policy to /abiomed/models/policy_models/SVR_hpo/abiomed/2025-08-27_03-43-24/svr_seed_1_9_gamma1_0.1_gamma2_0.2_gamma3_0.1.pth
