Starting trial 4 with gamma1=0.05, gamma2=0.5, gamma3=0.5
cuda:6
In env continuous
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
/home/ubuntu/miniconda3/envs/mopo/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/home/ubuntu/noisy_mujoco/abiomed_env/model.py:402: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(path, map_location=self.device)
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
No validation data for Abiomed dataset
0.05 0.5 0.5
torch.Size([17865, 6, 12]) torch.Size([17865, 6]) torch.Size([17865, 66])
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17865/17865 [00:08<00:00, 2196.09it/s]
-4.428163142542622 165.93485669748776
-2.736237 1.3035817
-5.897560220908415 83.67061508289387
-2.35 2.1392697494459263
1.0 1.0
/home/ubuntu/SVR/SVR_old/main.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  behav.load_state_dict(torch.load(bc_model_path))
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
EVAL ENVIRONMENT GAMMAS SET TO 0
 15%|███████████████████▎                                                                                                             | 29997/200000 [07:07<30:13, 93.77it/s]
-10.215226173400879
Time steps: 10000
---------------------------------------
Evaluation over 10 episodes: Return 3.246
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.2666666666666667
Super metric: 0.20000
---------------------------------------
-14.049257278442383
Time steps: 20000
---------------------------------------
Evaluation over 10 episodes: Return 2.402
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.13999999999999999
Super metric: 0.00000
---------------------------------------
-21.259418487548828
Time steps: 30000
---------------------------------------
Evaluation over 10 episodes: Return -0.996
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 8.333333333333332
Weaning score: 0.16499999999999998
Super metric: 0.20000
---------------------------------------
-36.92375183105469
Time steps: 40000
---------------------------------------
Evaluation over 10 episodes: Return 1.290
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 3.333333333333333
Weaning score: 0.02
Super metric: 0.20000
---------------------------------------
-56.56574249267578
Time steps: 50000
---------------------------------------
Evaluation over 10 episodes: Return 1.117
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.1
Super metric: 0.00000
---------------------------------------
-74.67738342285156
Time steps: 60000
---------------------------------------
Evaluation over 10 episodes: Return 0.580
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.08
Super metric: 0.30000
---------------------------------------
-94.50656127929688
Time steps: 70000
---------------------------------------
Evaluation over 10 episodes: Return -0.633
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 6.666666666666666
Weaning score: 0.02
Super metric: 0.10000
---------------------------------------
-117.44430541992188
Time steps: 80000
---------------------------------------
Evaluation over 10 episodes: Return -3.723
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 15.0
Weaning score: 0.02
Super metric: 0.20000
---------------------------------------
-139.52587890625
Time steps: 90000
---------------------------------------
Evaluation over 10 episodes: Return 0.644
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.06000000000000001
Super metric: 0.40000
---------------------------------------
-170.15286254882812
Time steps: 100000
---------------------------------------
Evaluation over 10 episodes: Return 0.343
ACP 0.3000
MAP AIR/ep: 0.05000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.10000
Aggregate AIR/ep: 0.85000
Unstable hours (%): 6.666666666666666
Weaning score: 0.15333333333333335
Super metric: 0.30000
---------------------------------------
-187.6525421142578
Time steps: 110000
---------------------------------------
Evaluation over 10 episodes: Return -2.790
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.07500
Aggregate AIR/ep: 0.57500
Unstable hours (%): 1.6666666666666665
Weaning score: 0.07333333333333333
Super metric: 0.30000
---------------------------------------
-199.96600341796875
Time steps: 120000
---------------------------------------
Evaluation over 10 episodes: Return 0.731
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.20000
Unstable hours (%): 23.333333333333332
Weaning score: 0.15333333333333332
Super metric: 0.60000
---------------------------------------
-223.17974853515625
Time steps: 130000
---------------------------------------
Evaluation over 10 episodes: Return -0.227
ACP 0.6000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.40000
Unstable hours (%): 4.999999999999999
Weaning score: 0.06999999999999999
Super metric: 0.80000
---------------------------------------
-224.92446899414062
Time steps: 140000
---------------------------------------
Evaluation over 10 episodes: Return 0.101
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 14.999999999999996
Weaning score: 0.15
Super metric: 0.30000
---------------------------------------
-232.87283325195312
Time steps: 150000
---------------------------------------
Evaluation over 10 episodes: Return 1.538
ACP 0.5000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 0.0
Weaning score: 0.21166666666666667
Super metric: 1.00000
---------------------------------------
-224.60340881347656
Time steps: 160000
---------------------------------------
Evaluation over 10 episodes: Return 1.353
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.30000
Unstable hours (%): 9.999999999999996
Weaning score: 0.045
Super metric: 0.30000
---------------------------------------
-223.48362731933594
Time steps: 170000
---------------------------------------
Evaluation over 10 episodes: Return -0.874
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 10.0
Weaning score: 0.19
Super metric: 0.20000
---------------------------------------
-223.38995361328125
Time steps: 180000
---------------------------------------
Evaluation over 10 episodes: Return -0.549
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: -0.02
Super metric: 0.70000
---------------------------------------
-209.84890747070312
Time steps: 190000
---------------------------------------
Evaluation over 10 episodes: Return 0.847
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 0.0
Weaning score: 0.18
Super metric: 0.10000
---------------------------------------
-209.88824462890625
Time steps: 200000
---------------------------------------
Evaluation over 100 episodes: Return 1.004
ACP 0.1900
MAP AIR/ep: 0.01000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00533
Aggregate AIR/ep: 0.63533
Unstable hours (%): 4.500000000000001
Weaning score: 0.1743333333333333
Super metric: 0.27000
---------------------------------------
Saved policy to /abiomed/models/policy_models/SVR_hpo/abiomed/2025-08-27_03-43-24/svr_seed_1_4_gamma1_0.05_gamma2_0.5_gamma3_0.5.pth
