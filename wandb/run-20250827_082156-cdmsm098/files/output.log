Starting trial 7 with gamma1=0.05, gamma2=0.7, gamma3=0.5
cuda:6
In env continuous
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
/home/ubuntu/miniconda3/envs/mopo/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/home/ubuntu/noisy_mujoco/abiomed_env/model.py:402: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(path, map_location=self.device)
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
No validation data for Abiomed dataset
0.05 0.7 0.5
torch.Size([17865, 6, 12]) torch.Size([17865, 6]) torch.Size([17865, 66])
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17865/17865 [00:08<00:00, 2096.46it/s]
-4.428163142542622 165.93485669748776
-2.736237 1.3035817
-5.897560220908415 83.67061508289387
-2.55 2.5392697494459258
1.0 1.0
/home/ubuntu/SVR/SVR_old/main.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  behav.load_state_dict(torch.load(bc_model_path))
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
EVAL ENVIRONMENT GAMMAS SET TO 0
 15%|███████████████████▎                                                                                                             | 29994/200000 [07:14<35:33, 79.69it/s]
-2.220417022705078
Time steps: 10000
---------------------------------------
Evaluation over 10 episodes: Return 3.127
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.4333333333333333
Super metric: 0.10000
---------------------------------------
-7.589630126953125
Time steps: 20000
---------------------------------------
Evaluation over 10 episodes: Return 2.317
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.24
Super metric: 0.00000
---------------------------------------
-13.473803520202637
Time steps: 30000
---------------------------------------
Evaluation over 10 episodes: Return -0.968
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 8.333333333333332
Weaning score: 0.25833333333333336
Super metric: 0.10000
---------------------------------------
-28.370004653930664
Time steps: 40000
---------------------------------------
Evaluation over 10 episodes: Return 1.120
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 3.333333333333333
Weaning score: 0.04
Super metric: 0.00000
---------------------------------------
-46.50373458862305
Time steps: 50000
---------------------------------------
Evaluation over 10 episodes: Return 1.081
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.18
Super metric: 0.00000
---------------------------------------
-63.492923736572266
Time steps: 60000
---------------------------------------
Evaluation over 10 episodes: Return 0.170
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.08
Super metric: 0.30000
---------------------------------------
-79.34991455078125
Time steps: 70000
---------------------------------------
Evaluation over 10 episodes: Return -0.769
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 6.666666666666666
Weaning score: 0.1
Super metric: 0.30000
---------------------------------------
-96.06941223144531
Time steps: 80000
---------------------------------------
Evaluation over 10 episodes: Return -3.721
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 15.0
Weaning score: 0.04
Super metric: 0.10000
---------------------------------------
-118.444580078125
Time steps: 90000
---------------------------------------
Evaluation over 10 episodes: Return 0.722
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.06
Super metric: 0.00000
---------------------------------------
-142.03024291992188
Time steps: 100000
---------------------------------------
Evaluation over 10 episodes: Return 0.132
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 6.666666666666666
Weaning score: 0.0
Super metric: 0.10000
---------------------------------------
-164.37881469726562
Time steps: 110000
---------------------------------------
Evaluation over 10 episodes: Return -3.039
ACP 0.8000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.07500
Aggregate AIR/ep: 0.57500
Unstable hours (%): 1.6666666666666665
Weaning score: -0.04666666666666667
Super metric: 0.10000
---------------------------------------
-177.51699829101562
Time steps: 120000
---------------------------------------
Evaluation over 10 episodes: Return 0.638
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.20000
Unstable hours (%): 21.666666666666664
Weaning score: 0.075
Super metric: 0.70000
---------------------------------------
-193.30548095703125
Time steps: 130000
---------------------------------------
Evaluation over 10 episodes: Return -0.202
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 4.999999999999999
Weaning score: 0.19
Super metric: 0.00000
---------------------------------------
-197.21710205078125
Time steps: 140000
---------------------------------------
Evaluation over 10 episodes: Return 0.148
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 14.999999999999996
Weaning score: 0.065
Super metric: 0.40000
---------------------------------------
-217.46932983398438
Time steps: 150000
---------------------------------------
Evaluation over 10 episodes: Return 1.498
ACP 0.7000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 0.0
Weaning score: 0.1933333333333333
Super metric: 1.30000
---------------------------------------
-216.91915893554688
Time steps: 160000
---------------------------------------
Evaluation over 10 episodes: Return 1.545
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.05000
Aggregate AIR/ep: 0.45000
Unstable hours (%): 9.999999999999996
Weaning score: 0.08
Super metric: 0.80000
---------------------------------------
-224.4650421142578
Time steps: 170000
---------------------------------------
Evaluation over 10 episodes: Return -0.938
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 10.0
Weaning score: 0.21000000000000002
Super metric: 0.30000
---------------------------------------
-225.68006896972656
Time steps: 180000
---------------------------------------
Evaluation over 10 episodes: Return -0.316
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.0
Super metric: 0.40000
---------------------------------------
-223.90623474121094
Time steps: 190000
---------------------------------------
Evaluation over 10 episodes: Return 0.966
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 0.0
Weaning score: 0.22000000000000003
Super metric: 0.10000
---------------------------------------
-214.9445343017578
Time steps: 200000
---------------------------------------
Evaluation over 100 episodes: Return 0.887
ACP 0.0600
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.01833
Aggregate AIR/ep: 0.63833
Unstable hours (%): 4.333333333333334
Weaning score: 0.13816666666666666
Super metric: 0.37000
---------------------------------------
Saved policy to /abiomed/models/policy_models/SVR_hpo/abiomed/2025-08-27_03-43-24/svr_seed_1_7_gamma1_0.05_gamma2_0.7_gamma3_0.5.pth
