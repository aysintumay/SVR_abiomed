Starting trial 14 with gamma1=0.1, gamma2=0.5, gamma3=1.0
cuda:6
In env continuous
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
/home/ubuntu/miniconda3/envs/mopo/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/home/ubuntu/noisy_mujoco/abiomed_env/model.py:402: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(path, map_location=self.device)
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
No validation data for Abiomed dataset
0.1 0.5 1.0
torch.Size([17865, 6, 12]) torch.Size([17865, 6]) torch.Size([17865, 66])
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17865/17865 [00:08<00:00, 2119.99it/s]
-4.428163142542622 165.93485669748776
-2.736237 1.3035817
-5.897560220908415 83.67061508289387
-2.7 2.6392697494459263
1.0 1.0
/home/ubuntu/SVR/SVR_old/main.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  behav.load_state_dict(torch.load(bc_model_path))
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
EVAL ENVIRONMENT GAMMAS SET TO 0
 15%|███████████████████▎                                                                                                             | 29998/200000 [06:29<31:52, 88.89it/s]
-4.032867431640625
Time steps: 10000
---------------------------------------
Evaluation over 10 episodes: Return 3.081
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.2533333333333333
Super metric: 0.20000
---------------------------------------
-4.719028472900391
Time steps: 20000
---------------------------------------
Evaluation over 10 episodes: Return 2.527
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.1
Super metric: 0.20000
---------------------------------------
-8.589164733886719
Time steps: 30000
---------------------------------------
Evaluation over 10 episodes: Return -0.512
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 8.333333333333332
Weaning score: 0.21833333333333332
Super metric: 0.10000
---------------------------------------
-26.021162033081055
Time steps: 40000
---------------------------------------
Evaluation over 10 episodes: Return 1.612
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 3.333333333333333
Weaning score: 0.06000000000000001
Super metric: 0.40000
---------------------------------------
-50.77925109863281
Time steps: 50000
---------------------------------------
Evaluation over 10 episodes: Return 1.140
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.1
Super metric: 0.10000
---------------------------------------
-75.46903228759766
Time steps: 60000
---------------------------------------
Evaluation over 10 episodes: Return 0.675
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.10666666666666666
Super metric: 0.30000
---------------------------------------
-97.8953628540039
Time steps: 70000
---------------------------------------
Evaluation over 10 episodes: Return -0.617
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 6.666666666666666
Weaning score: 0.1
Super metric: 0.40000
---------------------------------------
-125.72650909423828
Time steps: 80000
---------------------------------------
Evaluation over 10 episodes: Return -3.733
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 15.0
Weaning score: 0.085
Super metric: 0.10000
---------------------------------------
-156.512939453125
Time steps: 90000
---------------------------------------
Evaluation over 10 episodes: Return 0.510
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.06000000000000001
Super metric: 0.10000
---------------------------------------
-186.5456085205078
Time steps: 100000
---------------------------------------
Evaluation over 10 episodes: Return 0.139
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 4.999999999999999
Weaning score: 0.25166666666666665
Super metric: 0.20000
---------------------------------------
-205.50523376464844
Time steps: 110000
---------------------------------------
Evaluation over 10 episodes: Return -3.156
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.02500
Aggregate AIR/ep: 0.52500
Unstable hours (%): 1.6666666666666665
Weaning score: 0.24
Super metric: 0.00000
---------------------------------------
-224.87860107421875
Time steps: 120000
---------------------------------------
Evaluation over 10 episodes: Return 0.513
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.30000
Unstable hours (%): 21.666666666666664
Weaning score: 0.18
Super metric: 0.70000
---------------------------------------
-244.0972900390625
Time steps: 130000
---------------------------------------
Evaluation over 10 episodes: Return -0.236
ACP 0.6000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 4.999999999999999
Weaning score: 0.075
Super metric: 1.20000
---------------------------------------
-247.255126953125
Time steps: 140000
---------------------------------------
Evaluation over 10 episodes: Return 0.260
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 14.999999999999996
Weaning score: 0.15999999999999998
Super metric: 0.60000
---------------------------------------
-265.9857177734375
Time steps: 150000
---------------------------------------
Evaluation over 10 episodes: Return 1.298
ACP 2.6000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 0.0
Weaning score: 0.2333333333333333
Super metric: 2.90000
---------------------------------------
-263.99432373046875
Time steps: 160000
---------------------------------------
Evaluation over 10 episodes: Return 1.793
ACP 0.3000
MAP AIR/ep: 0.03333 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.10000
Aggregate AIR/ep: 0.33333
Unstable hours (%): 8.333333333333332
Weaning score: 0.10500000000000001
Super metric: 0.70000
---------------------------------------
-273.6409912109375
Time steps: 170000
---------------------------------------
Evaluation over 10 episodes: Return -0.880
ACP 0.7000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 10.0
Weaning score: 0.18
Super metric: 1.00000
---------------------------------------
-284.81646728515625
Time steps: 180000
---------------------------------------
Evaluation over 10 episodes: Return -0.279
ACP 1.3000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 0.0
Weaning score: 0.19333333333333333
Super metric: 1.40000
---------------------------------------
-278.7442626953125
Time steps: 190000
---------------------------------------
Evaluation over 10 episodes: Return 1.046
ACP 0.8000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.225
Super metric: 1.20000
---------------------------------------
-283.2610778808594
Time steps: 200000
---------------------------------------
Evaluation over 100 episodes: Return 0.945
ACP 1.5300
MAP AIR/ep: 0.00250 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.01183
Aggregate AIR/ep: 0.61433
Unstable hours (%): 4.833333333333334
Weaning score: 0.20249999999999996
Super metric: 1.63000
---------------------------------------
Saved policy to /abiomed/models/policy_models/SVR_hpo/abiomed/2025-08-27_03-43-24/svr_seed_1_14_gamma1_0.1_gamma2_0.5_gamma3_1.0.pth
