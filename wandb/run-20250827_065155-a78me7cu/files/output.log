Starting trial 5 with gamma1=0.05, gamma2=0.5, gamma3=1.0
cuda:6
In env continuous
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
/home/ubuntu/miniconda3/envs/mopo/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/home/ubuntu/noisy_mujoco/abiomed_env/model.py:402: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(path, map_location=self.device)
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
No validation data for Abiomed dataset
0.05 0.5 1.0
torch.Size([17865, 6, 12]) torch.Size([17865, 6]) torch.Size([17865, 66])
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17865/17865 [00:08<00:00, 2158.55it/s]
-4.428163142542622 165.93485669748776
-2.736237 1.3035817
-5.897560220908415 83.67061508289387
-2.35 2.6392697494459263
1.0 1.0
/home/ubuntu/SVR/SVR_old/main.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  behav.load_state_dict(torch.load(bc_model_path))
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
EVAL ENVIRONMENT GAMMAS SET TO 0
 15%|███████████████████▎                                                                                                             | 29992/200000 [07:41<36:15, 78.16it/s]
-2.0590920448303223
Time steps: 10000
---------------------------------------
Evaluation over 10 episodes: Return 3.246
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.2866666666666667
Super metric: 0.10000
---------------------------------------
-0.7524343729019165
Time steps: 20000
---------------------------------------
Evaluation over 10 episodes: Return 2.504
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.24
Super metric: 0.00000
---------------------------------------
-2.859424591064453
Time steps: 30000
---------------------------------------
Evaluation over 10 episodes: Return -0.430
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 8.333333333333332
Weaning score: 0.13999999999999999
Super metric: 0.20000
---------------------------------------
-15.658928871154785
Time steps: 40000
---------------------------------------
Evaluation over 10 episodes: Return 1.466
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 3.333333333333333
Weaning score: 0.046666666666666676
Super metric: 0.30000
---------------------------------------
-36.92375946044922
Time steps: 50000
---------------------------------------
Evaluation over 10 episodes: Return 1.004
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.165
Super metric: 0.20000
---------------------------------------
-59.65345001220703
Time steps: 60000
---------------------------------------
Evaluation over 10 episodes: Return 0.947
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.16999999999999998
Super metric: 0.20000
---------------------------------------
-89.92526245117188
Time steps: 70000
---------------------------------------
Evaluation over 10 episodes: Return -0.784
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 3.333333333333333
Weaning score: 0.08
Super metric: 0.20000
---------------------------------------
-118.37640380859375
Time steps: 80000
---------------------------------------
Evaluation over 10 episodes: Return -3.807
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 15.0
Weaning score: 0.12
Super metric: 0.10000
---------------------------------------
-158.50747680664062
Time steps: 90000
---------------------------------------
Evaluation over 10 episodes: Return 0.532
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.13833333333333334
Super metric: 0.10000
---------------------------------------
-185.92349243164062
Time steps: 100000
---------------------------------------
Evaluation over 10 episodes: Return 0.552
ACP 0.6000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 6.666666666666666
Weaning score: 0.07333333333333333
Super metric: 0.80000
---------------------------------------
-209.5841064453125
Time steps: 110000
---------------------------------------
Evaluation over 10 episodes: Return -2.700
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.15
Super metric: 0.30000
---------------------------------------
-231.0976104736328
Time steps: 120000
---------------------------------------
Evaluation over 10 episodes: Return 0.588
ACP 0.4000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.30000
Unstable hours (%): 21.666666666666664
Weaning score: 0.045
Super metric: 1.50000
---------------------------------------
-245.6676483154297
Time steps: 130000
---------------------------------------
Evaluation over 10 episodes: Return -0.275
ACP 1.2000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.40000
Unstable hours (%): 4.999999999999999
Weaning score: 0.06000000000000001
Super metric: 1.70000
---------------------------------------
-240.98797607421875
Time steps: 140000
---------------------------------------
Evaluation over 10 episodes: Return 0.146
ACP 0.6000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 14.999999999999996
Weaning score: 0.24000000000000005
Super metric: 1.30000
---------------------------------------
-239.7880859375
Time steps: 150000
---------------------------------------
Evaluation over 10 episodes: Return 1.131
ACP 2.1000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.4083333333333334
Super metric: 3.00000
---------------------------------------
-231.77505493164062
Time steps: 160000
---------------------------------------
Evaluation over 10 episodes: Return 1.658
ACP 1.4000
MAP AIR/ep: 0.03333 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.10000
Aggregate AIR/ep: 0.33333
Unstable hours (%): 8.333333333333332
Weaning score: 0.21000000000000002
Super metric: 1.90000
---------------------------------------
-220.73519897460938
Time steps: 170000
---------------------------------------
Evaluation over 10 episodes: Return -1.580
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 11.666666666666666
Weaning score: 0.19333333333333333
Super metric: 0.50000
---------------------------------------
-214.0437469482422
Time steps: 180000
---------------------------------------
Evaluation over 10 episodes: Return -0.576
ACP 1.4000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 0.0
Weaning score: 0.19666666666666666
Super metric: 1.80000
---------------------------------------
-196.8483428955078
Time steps: 190000
---------------------------------------
Evaluation over 10 episodes: Return 1.084
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 0.0
Weaning score: 0.14000000000000004
Super metric: 0.10000
---------------------------------------
-192.94033813476562
Time steps: 200000
---------------------------------------
Evaluation over 100 episodes: Return 0.890
ACP 0.3700
MAP AIR/ep: 0.01333 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.01733
Aggregate AIR/ep: 0.61067
Unstable hours (%): 4.666666666666668
Weaning score: 0.18333333333333324
Super metric: 0.40000
---------------------------------------
Saved policy to /abiomed/models/policy_models/SVR_hpo/abiomed/2025-08-27_03-43-24/svr_seed_1_5_gamma1_0.05_gamma2_0.5_gamma3_1.0.pth
