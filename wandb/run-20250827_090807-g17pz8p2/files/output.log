Starting trial 8 with gamma1=0.05, gamma2=0.7, gamma3=1.0
cuda:6
In env continuous
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
/home/ubuntu/miniconda3/envs/mopo/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/home/ubuntu/noisy_mujoco/abiomed_env/model.py:402: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(path, map_location=self.device)
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
No validation data for Abiomed dataset
0.05 0.7 1.0
torch.Size([17865, 6, 12]) torch.Size([17865, 6]) torch.Size([17865, 66])
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17865/17865 [00:08<00:00, 2181.65it/s]
-4.428163142542622 165.93485669748776
-2.736237 1.3035817
-5.897560220908415 83.67061508289387
-2.35 3.0392697494459258
1.0 1.0
/home/ubuntu/SVR/SVR_old/main.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  behav.load_state_dict(torch.load(bc_model_path))
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
EVAL ENVIRONMENT GAMMAS SET TO 0
 15%|███████████████████▎                                                                                                             | 29995/200000 [06:25<33:36, 84.31it/s]
-0.08082002401351929
Time steps: 10000
---------------------------------------
Evaluation over 10 episodes: Return 3.194
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.2266666666666667
Super metric: 0.10000
---------------------------------------
-0.2669735848903656
Time steps: 20000
---------------------------------------
Evaluation over 10 episodes: Return 2.508
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.28
Super metric: 0.10000
---------------------------------------
-4.227019309997559
Time steps: 30000
---------------------------------------
Evaluation over 10 episodes: Return -0.500
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 8.333333333333332
Weaning score: 0.21166666666666667
Super metric: 0.20000
---------------------------------------
-19.252214431762695
Time steps: 40000
---------------------------------------
Evaluation over 10 episodes: Return 1.165
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 3.333333333333333
Weaning score: 0.1
Super metric: 0.00000
---------------------------------------
-42.35833740234375
Time steps: 50000
---------------------------------------
Evaluation over 10 episodes: Return 1.080
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.15
Super metric: 0.20000
---------------------------------------
-65.06536865234375
Time steps: 60000
---------------------------------------
Evaluation over 10 episodes: Return 0.436
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.12666666666666665
Super metric: 0.30000
---------------------------------------
-86.99491882324219
Time steps: 70000
---------------------------------------
Evaluation over 10 episodes: Return -0.575
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 6.666666666666666
Weaning score: 0.08
Super metric: 0.50000
---------------------------------------
-116.6189193725586
Time steps: 80000
---------------------------------------
Evaluation over 10 episodes: Return -3.767
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 15.0
Weaning score: 0.08
Super metric: 0.30000
---------------------------------------
-145.40403747558594
Time steps: 90000
---------------------------------------
Evaluation over 10 episodes: Return 0.553
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.02000
Aggregate AIR/ep: 0.62000
Unstable hours (%): 3.333333333333333
Weaning score: 0.11333333333333333
Super metric: 0.30000
---------------------------------------
-182.3096923828125
Time steps: 100000
---------------------------------------
Evaluation over 10 episodes: Return 0.383
ACP 0.5000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 4.999999999999999
Weaning score: 0.04
Super metric: 0.60000
---------------------------------------
-198.51876831054688
Time steps: 110000
---------------------------------------
Evaluation over 10 episodes: Return -3.389
ACP 0.5000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.10000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.22999999999999998
Super metric: 0.70000
---------------------------------------
-220.95761108398438
Time steps: 120000
---------------------------------------
Evaluation over 10 episodes: Return 0.744
ACP 1.2000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.20000
Unstable hours (%): 26.666666666666664
Weaning score: 0.11166666666666666
Super metric: 1.70000
---------------------------------------
-233.19961547851562
Time steps: 130000
---------------------------------------
Evaluation over 10 episodes: Return -0.092
ACP 2.1000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.40000
Unstable hours (%): 4.999999999999999
Weaning score: 0.21833333333333332
Super metric: 2.80000
---------------------------------------
-235.27117919921875
Time steps: 140000
---------------------------------------
Evaluation over 10 episodes: Return 0.155
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 13.333333333333332
Weaning score: 0.09
Super metric: 0.70000
---------------------------------------
-239.7412567138672
Time steps: 150000
---------------------------------------
Evaluation over 10 episodes: Return 1.461
ACP 3.5000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.02000
Aggregate AIR/ep: 0.52000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.2483333333333333
Super metric: 4.00000
---------------------------------------
-233.59939575195312
Time steps: 160000
---------------------------------------
Evaluation over 10 episodes: Return 1.632
ACP 1.4000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.30000
Unstable hours (%): 8.333333333333332
Weaning score: 0.17166666666666666
Super metric: 1.40000
---------------------------------------
-231.79193115234375
Time steps: 170000
---------------------------------------
Evaluation over 10 episodes: Return -1.058
ACP 1.5000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 11.666666666666666
Weaning score: 0.22000000000000003
Super metric: 1.80000
---------------------------------------
-233.51358032226562
Time steps: 180000
---------------------------------------
Evaluation over 10 episodes: Return -0.905
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.14
Super metric: 0.30000
---------------------------------------
-221.92689514160156
Time steps: 190000
---------------------------------------
Evaluation over 10 episodes: Return 1.010
ACP 1.3000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.18
Super metric: 1.50000
---------------------------------------
-223.205810546875
Time steps: 200000
---------------------------------------
Evaluation over 100 episodes: Return 1.005
ACP 0.9600
MAP AIR/ep: 0.01000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.01533
Aggregate AIR/ep: 0.61533
Unstable hours (%): 5.666666666666668
Weaning score: 0.19666666666666666
Super metric: 1.22000
---------------------------------------
Saved policy to /abiomed/models/policy_models/SVR_hpo/abiomed/2025-08-27_03-43-24/svr_seed_1_8_gamma1_0.05_gamma2_0.7_gamma3_1.0.pth
