Starting trial 24 with gamma1=0.2, gamma2=0.7, gamma3=0.1
cuda:6
In env continuous
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
/home/ubuntu/miniconda3/envs/mopo/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
/home/ubuntu/noisy_mujoco/abiomed_env/model.py:402: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(path, map_location=self.device)
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
No validation data for Abiomed dataset
0.2 0.7 0.1
torch.Size([17865, 6, 12]) torch.Size([17865, 6]) torch.Size([17865, 66])
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17865/17865 [00:08<00:00, 2109.93it/s]
-4.428163142542622 165.93485669748776
-2.736237 1.3035817
-5.897560220908415 83.67061508289387
-4.0 2.1392697494459263
1.0 1.0
/home/ubuntu/SVR/SVR_old/main.py:94: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  behav.load_state_dict(torch.load(bc_model_path))
<module 'config' from '/home/ubuntu/noisy_mujoco/abiomed_env/config.py'>
time series transformer device cuda:6
Using device: cuda:6
Model loaded from /abiomed/downsampled/models/10min_1hr_all_data_model.pth
loaded datasets with length
 train:  12051
 val:  1938
 test:  3876
Data loaded from /abiomed/downsampled/10min_1hr_all_data.pkl
Continuous action space. Min action: -2.2312597235306466, Max action: 1.8085589693336617
EVAL ENVIRONMENT GAMMAS SET TO 0
 15%|███████████████████                                                                                                            | 29999/200000 [07:32<1:10:55, 39.95it/s]
-15.062286376953125
Time steps: 10000
---------------------------------------
Evaluation over 10 episodes: Return 3.154
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.23000000000000004
Super metric: 0.20000
---------------------------------------
-25.11728286743164
Time steps: 20000
---------------------------------------
Evaluation over 10 episodes: Return 2.679
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.90000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.12
Super metric: 0.30000
---------------------------------------
-40.23033905029297
Time steps: 30000
---------------------------------------
Evaluation over 10 episodes: Return -0.706
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 8.333333333333332
Weaning score: 0.265
Super metric: 0.00000
---------------------------------------
-69.57998657226562
Time steps: 40000
---------------------------------------
Evaluation over 10 episodes: Return 1.110
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 3.333333333333333
Weaning score: 0.18
Super metric: 0.30000
---------------------------------------
-107.52054595947266
Time steps: 50000
---------------------------------------
Evaluation over 10 episodes: Return 1.061
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 3.333333333333333
Weaning score: 0.19999999999999998
Super metric: 0.00000
---------------------------------------
-138.1441650390625
Time steps: 60000
---------------------------------------
Evaluation over 10 episodes: Return 0.736
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.195
Super metric: 0.10000
---------------------------------------
-174.78512573242188
Time steps: 70000
---------------------------------------
Evaluation over 10 episodes: Return -0.795
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 6.666666666666666
Weaning score: 0.12
Super metric: 0.20000
---------------------------------------
-208.3539276123047
Time steps: 80000
---------------------------------------
Evaluation over 10 episodes: Return -3.746
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 16.666666666666664
Weaning score: 0.02
Super metric: 0.10000
---------------------------------------
-238.6015625
Time steps: 90000
---------------------------------------
Evaluation over 10 episodes: Return 0.687
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.04000
Aggregate AIR/ep: 0.64000
Unstable hours (%): 3.333333333333333
Weaning score: 0.04
Super metric: 0.00000
---------------------------------------
-266.2182922363281
Time steps: 100000
---------------------------------------
Evaluation over 10 episodes: Return 0.005
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 6.666666666666666
Weaning score: 0.06000000000000001
Super metric: 0.00000
---------------------------------------
-287.64202880859375
Time steps: 110000
---------------------------------------
Evaluation over 10 episodes: Return -3.090
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.12
Super metric: 0.20000
---------------------------------------
-304.4753112792969
Time steps: 120000
---------------------------------------
Evaluation over 10 episodes: Return 0.491
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.20000
Unstable hours (%): 21.666666666666664
Weaning score: 0.025
Super metric: 0.30000
---------------------------------------
-322.20550537109375
Time steps: 130000
---------------------------------------
Evaluation over 10 episodes: Return -0.104
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.50000
Unstable hours (%): 4.999999999999999
Weaning score: 0.095
Super metric: 0.40000
---------------------------------------
-322.90118408203125
Time steps: 140000
---------------------------------------
Evaluation over 10 episodes: Return 0.116
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.60000
Unstable hours (%): 14.999999999999996
Weaning score: 0.22999999999999998
Super metric: 0.50000
---------------------------------------
-344.0960693359375
Time steps: 150000
---------------------------------------
Evaluation over 10 episodes: Return 1.290
ACP 1.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 0.0
Weaning score: 0.1983333333333333
Super metric: 1.20000
---------------------------------------
-344.96234130859375
Time steps: 160000
---------------------------------------
Evaluation over 10 episodes: Return 1.721
ACP 1.0000
MAP AIR/ep: 0.10000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.40000
Unstable hours (%): 8.333333333333332
Weaning score: 0.155
Super metric: 0.00000
---------------------------------------
-355.33306884765625
Time steps: 170000
---------------------------------------
Evaluation over 10 episodes: Return -1.070
ACP 2.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.70000
Unstable hours (%): 11.666666666666666
Weaning score: 0.045
Super metric: 2.00000
---------------------------------------
-361.350830078125
Time steps: 180000
---------------------------------------
Evaluation over 10 episodes: Return -0.672
ACP 1.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 1.6666666666666665
Weaning score: 0.08
Super metric: 0.70000
---------------------------------------
-348.58685302734375
Time steps: 190000
---------------------------------------
Evaluation over 10 episodes: Return 1.132
ACP 0.0000
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00000
Aggregate AIR/ep: 0.80000
Unstable hours (%): 0.0
Weaning score: 0.20500000000000002
Super metric: 0.20000
---------------------------------------
-348.11578369140625
Time steps: 200000
---------------------------------------
Evaluation over 100 episodes: Return 0.922
ACP 0.2600
MAP AIR/ep: 0.00000 | HR AIR/ep: 0.00000 | Pulsatility AIR/ep: 0.00250
Aggregate AIR/ep: 0.60250
Unstable hours (%): 4.666666666666668
Weaning score: 0.23499999999999985
Super metric: 0.67000
---------------------------------------
Saved policy to /abiomed/models/policy_models/SVR_hpo/abiomed/2025-08-27_03-43-24/svr_seed_1_24_gamma1_0.2_gamma2_0.7_gamma3_0.1.pth
